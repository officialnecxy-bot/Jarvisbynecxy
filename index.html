<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J.A.R.V.I.S - MARK 42</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon: #00f3ff;
            --dark: #050505;
            --glass: rgba(0, 243, 255, 0.05);
            --border: 1px solid rgba(0, 243, 255, 0.3);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: var(--dark);
            color: var(--neon);
            font-family: 'Share Tech Mono', monospace;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-image: radial-gradient(circle at center, #0a151f 0%, #000 70%);
        }

        /* --- BACKGROUND GRID --- */
        .grid-bg {
            position: absolute;
            width: 100%; height: 100%;
            background: 
                linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -1;
        }

        /* --- ARC REACTOR (CORE) --- */
        .reactor-container {
            position: relative;
            width: 300px; height: 300px;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer;
            transition: 0.5s;
        }
        
        .reactor-container:active { transform: scale(0.95); }

        .circle {
            position: absolute;
            border-radius: 50%;
            border: 1px solid var(--neon);
            box-shadow: 0 0 10px var(--glass);
        }

        .c1 { width: 100%; height: 100%; border: 2px dashed var(--neon); animation: spin 10s linear infinite; opacity: 0.5; }
        .c2 { width: 85%; height: 85%; border-top: 2px solid var(--neon); border-bottom: 2px solid var(--neon); animation: spin-rev 5s linear infinite; }
        .c3 { width: 70%; height: 70%; border: 1px solid rgba(0,243,255,0.3); box-shadow: inset 0 0 20px var(--neon); }
        .c4 { width: 40%; height: 40%; background: radial-gradient(circle, #fff 0%, var(--neon) 40%, transparent 70%); box-shadow: 0 0 50px var(--neon); animation: pulse 2s infinite ease-in-out; }

        .reactor-container.listening .c4 { background: radial-gradient(circle, #fff 0%, #ff003c 40%, transparent 70%); box-shadow: 0 0 60px #ff003c; }
        .reactor-container.listening .circle { border-color: #ff003c; }

        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes spin-rev { 100% { transform: rotate(-360deg); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.1); opacity: 1; } }

        /* --- HUD INFO --- */
        .hud-top {
            position: absolute; top: 20px; width: 90%;
            display: flex; justify-content: space-between;
            text-transform: uppercase; letter-spacing: 2px; font-size: 0.9rem;
        }
        .status-box { padding: 10px 20px; border: var(--border); background: var(--glass); border-left: 3px solid var(--neon); }

        /* --- TERMINAL LOG --- */
        .terminal {
            position: absolute; left: 20px; bottom: 20px;
            width: 300px; height: 150px;
            font-size: 0.8rem; color: rgba(0, 243, 255, 0.7);
            overflow: hidden;
            text-shadow: 0 0 5px var(--neon);
            border-left: 1px solid var(--neon);
            padding-left: 10px;
        }
        .term-line { margin-bottom: 5px; animation: fadeUp 0.3s ease-out; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- SOUND WAVES --- */
        .waves {
            position: absolute; bottom: 50px;
            display: flex; gap: 5px; height: 30px; align-items: center;
        }
        .bar { width: 5px; background: var(--neon); animation: none; border-radius: 2px; height: 5px; }
        
        .listening .bar { animation: wave 0.5s infinite ease-in-out; }
        @keyframes wave { 0%, 100% { height: 5px; } 50% { height: 40px; } }
        
        /* Delays for wave */
        .bar:nth-child(1) { animation-delay: 0.1s; }
        .bar:nth-child(2) { animation-delay: 0.2s; }
        .bar:nth-child(3) { animation-delay: 0.3s; }
        .bar:nth-child(4) { animation-delay: 0.4s; }
        .bar:nth-child(5) { animation-delay: 0.5s; }

        /* --- MAIN TEXT --- */
        .main-text { margin-top: 40px; font-size: 1.5rem; text-align: center; text-transform: uppercase; letter-spacing: 3px; min-height: 30px; }
        .sub-text { font-size: 0.9rem; color: rgba(255,255,255,0.6); margin-top: 10px; max-width: 80%; text-align: center; }

    </style>
</head>
<body>

    <div class="grid-bg"></div>

    <div class="hud-top">
        <div class="status-box">SYSTEM: ONLINE</div>
        <div class="status-box">CPU: <span id="cpu">34%</span></div>
        <div class="status-box">MEM: <span id="mem">12TB</span></div>
    </div>

    <div class="reactor-container" id="reactor" onclick="jarvis.toggle()">
        <div class="circle c1"></div>
        <div class="circle c2"></div>
        <div class="circle c3"></div>
        <div class="circle c4"></div>
    </div>

    <div class="main-text" id="status-display">TAP CORE TO INITIALIZE</div>
    <div class="sub-text" id="user-transcript"></div>

    <div class="waves" id="wave-box">
        <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
    </div>

    <div class="terminal" id="console-log">
        </div>

<script>
    // --- CONFIGURATION ---
    const CONFIG = {
        // YOUR PROVIDED KEY
        API_KEY: "AIzaSyAzINqsAHdMMLiXpLCwet0O540MB5xX5qg", 
        NAME: "Jarvis"
    };

    // --- SYSTEM LOGIC ---
    const jarvis = {
        recognition: null,
        isListening: false,
        isSpeaking: false,

        init: () => {
            jarvis.log("System booting up...");
            jarvis.log("Checking audio drivers...");
            
            if ('webkitSpeechRecognition' in window) {
                const SpeechRecognition = window.webkitSpeechRecognition;
                jarvis.recognition = new SpeechRecognition();
                jarvis.recognition.continuous = false;
                jarvis.recognition.lang = 'en-US';
                jarvis.recognition.interimResults = false;

                jarvis.recognition.onstart = () => {
                    jarvis.isListening = true;
                    document.getElementById('reactor').classList.add('listening');
                    document.getElementById('wave-box').classList.add('listening');
                    document.getElementById('status-display').innerText = "LISTENING...";
                    jarvis.log("Microphone active.");
                };

                jarvis.recognition.onend = () => {
                    jarvis.isListening = false;
                    document.getElementById('reactor').classList.remove('listening');
                    document.getElementById('wave-box').classList.remove('listening');
                    if (!jarvis.isSpeaking) document.getElementById('status-display').innerText = "STANDBY";
                };

                jarvis.recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('user-transcript').innerText = `"${transcript}"`;
                    jarvis.log("Input received: " + transcript);
                    jarvis.process(transcript);
                };
                
                jarvis.log("Voice module loaded.");
                jarvis.speak("System online. Touch the core to begin.");
            } else {
                jarvis.log("CRITICAL ERROR: Browser not supported.");
                alert("Use Chrome Browser.");
            }
        },

        toggle: () => {
            if (jarvis.isSpeaking) {
                window.speechSynthesis.cancel();
                jarvis.isSpeaking = false;
                jarvis.log("Audio output terminated.");
            }
            
            if (jarvis.isListening) {
                jarvis.recognition.stop();
            } else {
                try {
                    jarvis.recognition.start();
                    // Play a small beep sound logic here if needed
                } catch (e) { console.error(e); }
            }
        },

        log: (text) => {
            const term = document.getElementById('console-log');
            const line = document.createElement('div');
            line.className = 'term-line';
            line.innerText = `> ${text}`;
            term.appendChild(line);
            term.scrollTop = term.scrollHeight;
        },

        speak: (text) => {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            
            // Try to find a good voice
            const voices = window.speechSynthesis.getVoices();
            const botVoice = voices.find(v => v.name.includes("Google US English")) || voices[0];
            if(botVoice) utterance.voice = botVoice;
            
            utterance.rate = 1;
            utterance.pitch = 1;

            jarvis.isSpeaking = true;
            document.getElementById('status-display').innerText = "PROCESSING DATA...";
            
            utterance.onend = () => {
                jarvis.isSpeaking = false;
                document.getElementById('status-display').innerText = "STANDBY";
            };

            window.speechSynthesis.speak(utterance);
        },

        process: async (cmd) => {
            const command = cmd.toLowerCase();

            // 1. LOCAL COMMANDS (Fast)
            if (command.includes("time")) {
                jarvis.speak("It is currently " + new Date().toLocaleTimeString());
            } 
            else if (command.includes("date")) {
                jarvis.speak("Today is " + new Date().toDateString());
            }
            else if (command.includes("open google")) {
                jarvis.speak("Opening Google search.");
                window.open("https://google.com", "_blank");
            }
            else if (command.includes("shutdown") || command.includes("stop")) {
                jarvis.speak("Shutting down systems. Goodbye sir.");
                document.body.style.filter = "grayscale(100%)";
            }
            // 2. AI COMMANDS (Gemini)
            else {
                jarvis.log("Routing to Gemini Server...");
                await jarvis.askGemini(cmd);
            }
        },

        askGemini: async (prompt) => {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${CONFIG.API_KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: "You are Jarvis, an advanced AI. Answer briefly and professionally in 1 or 2 sentences. User says: " + prompt }] }]
                    })
                });

                const data = await response.json();
                
                if(data.error) {
                    jarvis.log("API Error: " + data.error.message);
                    jarvis.speak("I am encountering a server error, sir.");
                    return;
                }

                const reply = data.candidates[0].content.parts[0].text;
                const cleanReply = reply.replace(/[*#`]/g, ''); // Remove markdown
                
                jarvis.log("Response generated.");
                jarvis.speak(cleanReply);

            } catch (error) {
                jarvis.log("Network Error.");
                jarvis.speak("I cannot reach the cloud servers right now.");
            }
        }
    };

    // Random HUD Animation
    setInterval(() => {
        document.getElementById('cpu').innerText = Math.floor(Math.random() * 40 + 10) + "%";
        document.getElementById('mem').innerText = Math.floor(Math.random() * 5 + 10) + "TB";
    }, 2000);

    // Start
    window.onload = jarvis.init;

</script>
</body>
</html>
